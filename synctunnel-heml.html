<h1>SyncTunnel 教程</h1>
如果排版错乱可以更换浏览器
<h2>1 软件下载与安装</h2>
<p>想要下载软件，你可以访问 <a href="https://nnpyro.netlify.app/synctunnel.html">SyncTunnel的官网</a> 进行下载。</p>
<h2>2 软件操作</h2>
<h3>2.1 熟悉软件</h3>
<p>本软件的最新版本是 <code>beta 1.2.5</code> 版本。<br>
此版本的界面如下：
<img src="https://github.com/nnpyro1/html1/blob/071dcb8159ee5be023cd499eb4bdf80b4aadbe35/imgs_const/img_main.png?raw=true" alt="beta 1.2.5界面"></p>
<p>以下有对界面部分的介绍</p>
<ul>
<li>菜单栏:应用程序顶部包含了 <code>文件(F)</code> 的区域</li>
<li>页面栏:应用程序左侧竖向的，包含 <code>文件视图</code> <code>设置</code> <code>用户协议</code> <code>调试</code>等按钮的区域</li>
<li>主页面:应用程序中间的大块区域</li>
<li>信息显示区:应用程序右下角显示了应用程序当前状态的区域</li>
</ul>
<h3>2.2 快速配置</h3>
<blockquote>
<p>本段讲述了安装应用程序后如何进行配置。
本应用程序以配置简单著称，配置过程十分精简。</p>
</blockquote>
<h4>2.2.1 必要配置</h4>
<blockquote>
<p>此段是使用软件必要的配置，配置完成后可以使用基础功能。</p>
</blockquote>
<p>想要使用本软件，你需要先设置用户名/加密密码。</p>
<ol>
<li>点击软件左侧页面栏的“设置”按钮，切换到设置页面。设置页面的界面如图所示：<img src="https://github.com/nnpyro1/html1/blob/main/imgs_const/img_settings.png?raw=true" alt="设置页面"></li>
<li>自己想一个用户名填写在 <code>用户名</code> 字段，填写密码到 <code>密码</code>字段。本软件<strong>无需注册</strong>,填写好后就生效。如果是刚刚下载本软件的用户，请<strong>只填写用户名和密码字段</strong>，不知用途，不要修改通信设置里面的内容。</li>
<li>填写完用户名密码核对无误后请点击 <code>保存设置</code> 按钮。应用程序自动重启，完成设置。</li>
</ol>
<blockquote>
<h5>重要安全提示</h5>
<p>请务必修改默认的用户名和密码。使用默认的用户名密码会让您的数据非常危险，极易被盗取。</p>
<p>请务必记住您的密码。若密码遗忘会导致数据无法解密。</p>
<p>本软件没有密码验证系统，这会导致两个人用一样的用户名时，软件自动将其视为同一个用户。请将用户名设为不容易重名的名字。请勿将用户名设为"666""1234"等重名率高的名字。建议用户名5字符以上。</p>
</blockquote>
<p>如果是刚刚下载本软件的用户，请点击<a href="">这里</a>继续学习使用方法。</p>
<h4>2.2.2 其他配置</h4>
<h5>2.2.2.1 配置MQTT</h5>
<blockquote>
<h6>重要安全提示</h6>
<p>用户信息使用范围
<br>
本软件收集的通过MQTT传输的信息列表:</p>
<ul>
<li>用户由路由器映射的临时公网IP地址（含路由器公网IP）</li>
<li>用户的公网IPv6地址（如果支持）</li>
</ul>
<p>声明：
本软件所有传输的数据都使用用户的密码进行AES-256加密，但使用的服务器是测试服务器broker.emqx.io:1883不保证联接的安全性。如果介意，请自行更换！
开发者保证MQTT服务只传输上述列出的数据，不传输用户发送的文件内容，即使数据泄露，不会直接威胁到文件的安全。</p>
</blockquote>
<p>软件提供更换MQTT服务器地址的功能。
输入服务器的地址和端口，点击 <code>保存设置</code>按钮，应用程序自动重启，完成设置。
如果服务器突然无法使用，可以尝试更换服务器。
下表列出了常见的服务器。注意：他们大多数是测试服务器，若需其他服务器可自行查找。主要的服务器提供商有<a href="https://broker.emqx.io">EMQ(现在称为EMQX)</a>和<a href="https://test.mosquitto.org">Mosquitto</a></p>
<table>
    <caption>免费MQTT服务器资源</caption>
    <thead>
        <tr>
            <th>名称</th>
            <th>地址(对应输入到<code>MQTT服务器地址</code>字段)</th>
            <th>端口地址(对应输入到<code>MQTT服务器端口</code>字段)</th>
            <th>备注</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>EMQ</td>
            <td>broker.emqx.io</td>
            <td>1883</td>
            <td>默认服务器</td>
        </tr>
        <tr>
            <td>EMQ</td>
            <td>broker-cn.emqx.io</td>
            <td>1883</td>
            <td>EMQ的中国服务器，未经测试</td>
        </tr>
        <tr>
            <td>EMQ</td>
            <td>broker.emqx.io</td>
            <td>8883</td>
            <td>EMQ的中国服务器，有TLS加密，保证数据安全，未经测试,大概率不兼容</td>
        </tr>
                <tr>
            <td>Mosquitto</td>
            <td>test.mosquitto.org</td>
            <td>1883</td>
            <td>未经测试</td>
        </tr>
    </tbody>
</table>
<br>
<br>
<h5>2.2.2.2 配置文件挂起</h5>
<p>前言：基础功能只能实现在两个客户端同时在线时才可以进行互传文件。当其中一方离线时，另一方无法得到文件。因此为了满足大部分的需要，SyncTunnel软件提供文件挂起服务.
文件挂起需要在最后一个客户端离线之前手动操作。后续会增加自动挂起功能。手动挂起后数据会保存在Github服务器上，等到第一个客户端上线后手动下载文件，自动删除Github上面的文件。</p>
<blockquote>
<h6>重要安全提示</h6>
<p>用户信息使用范围</p>
<ul>
<li>用户的文件数据（已加密）</li>
</ul>
<p>我们保证，只要用户正确设置了密码，文件一定会被加密。</p>
</blockquote>
<br>
<h6>2.2.2.2.1 配置Github</h6>
<ol>
<li>打开<a href="https://github.com">Github官网</a>，点击右上角的<code>Sign up</code>按钮进入注册页面，或点击<a href="https://github.com/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F&amp;source=header-home">链接</a>直接进入注册页面，按照提示填写邮箱、密码、用户名（请记牢）和密码，验证账号后，进入<a href="https://github.com">主页</a></li>
<li>点击右上角的<code>+</code>，在弹出的菜单中选择<code>new repository</code>或<code>新建仓库</code></li>
<li>填写字段：将<code>Repository name</code>字段填写为<code>synctunnel-filehangup</code>，建议把<code>Choose visibility</code>填写为<code>Private</code></li>
<li>点击右下角的绿色按钮，创建仓库。</li>
<li>创建PAT：在主页点击右上角用户头像，选择弹出来的列表中的<code>Settings</code>按钮，在左侧的菜单中滚动到最底下，选择<code>Developer settings</code>。接着在新出现的页面中点击左侧的<code>Personal Access Tokens</code>，选择第一个<code>Fine-Grained tokens</code>，点击<code>Generate new token</code>，输入账户的密码。</li>
<li>在页面中填写名称、描述等信息，滚动到底部，设置<code>Repository access</code>为<code>All repositories</code>。</li>
<li>在页面底部的Permissions字段下面的方框的右上角点击<code>Add permissions</code>，选择<code>Contents</code>（温馨提示：不要用搜索工具，搜不出来）把新出现的两行的右边的下拉框都改成<code>Read and write</code>
最终效果如图所示<img src="https://github.com/nnpyro1/html1/blob/main/imgs_const/img_github1.png?raw=true" alt=""></li>
<li>点击绿色按钮后尽快复制页面上的token。此token只显示一次，请务必妥善保存</li>
</ol>
<h6>2.2.2.2.2 配置应用程序</h6>
<p><img src="https://github.com/nnpyro1/html1/blob/main/imgs_const/img_settings.png?raw=true" alt="">
打开SyncTunnel，转到“设置”页面，将注册Github时用的账号名称（不是邮件）填入<code>Github账号</code>字段，将刚刚复制的token填入<code>Github PAT</code>中，点击“保存设置”，应用程序自动重启，设置完成。</p>
<p><br><br><br></p>
<h3>2.3 功能介绍与使用</h3>
<h4>功能介绍</h4>
<p>本软件是数据同步软件，可以在不同设备之间同步数据。默认情况采用STUN打洞进行文件同步。当路由器设备不支持STUN时可以自动切换到IPv6直连传输。
在使用之前，需要先点击左侧页面栏的<code>用户协议</code>认真阅读并同意。</p>
<h4>2.3.1 打开软件</h4>
<p>打开软件时，新用户默认自动切换到<code>用户协议</code>页面，之后打开默认切换到<code>文件视图</code>页面。
打开软件后，请不要立即使用。请关注右下角的提示。</p>
<ul>
<li>右下角显示"正在获取公网IP"且超过1秒，代表STUN失败。如果应用程序稍后没有自动重启，则说明成功切换到了IPv6模式，不影响使用。</li>
<li>显示"正在获取用户列表"，说明系统正在获取用户列表</li>
<li>显示"加载成功"后，方可开始使用</li>
</ul>
<h4>2.3.2 同步文件</h4>
<p>在同步文件前，请确保</p>
<ul>
<li>你的用户名和密码与要同步的客户端的用户名和密码设置完全相同。只有相同的用户名和密码才可以相互同步文件。</li>
<li>文件列表中有文件或文件夹。如果没有，切换到<code>文件视图</code>页面，在页面空白处点击右键，选择"在文件管理器中打开"，放入文件后方可同步。</li>
</ul>
<p>您可以通过按下快键键<code>Ctrl+U</code>或者点击菜单栏中的<code>文件</code>，点击<code>同步文件</code>来同步文件</p>
<p>下面是一份表格，标识了文件同步过程中右下角可能出现的文字</p>
<table>
    <caption>发送端</caption>
    <thead>
        <tr>
            <th>出现的文字</th>
            <th>含义</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>正在加载文件</td>
            <td>正在对文件进行加载、加密、分片等操作</td>
        </tr>
        <tr>
            <td>正在发送文件，包1/1234 时间:3秒 速度1586kb/s</td>
            <td>文件正在发送，标识了速度、已用时间和发送进度</td>
        </tr>
        <tr>
            <td>发送文件完毕</td>
            <td>文件的发送操作完成。<strong>注意，文件没有真正发送完成，还有重传步骤未进行！</strong></td>
        </tr>
        <tr>
            <td>正在回复重传请求</td>
            <td>正在回复其他客户端发来的重传请求</td>
        </tr>
        <tr>
            <td>文件释放完成</td>
            <td>真正意义上的文件发送完成</td>
        </tr>
    </tbody>
</table>
<table>
    <caption>接收端</caption>
    <thead>
        <tr>
            <th>出现的文字</th>
            <th>含义</th>
        </tr>
    </thead>
    <tbody>
        <tr>
        </tr><tr>
            <td>正在接收文件，包1/1234</td>
            <td>文件正在接收</td>
        </tr>
        <tr>
            <td>文件操作完成</td>
            <td>文件的操作完成。<strong>注意，文件没有真正接收完成，还有重传步骤未进行！</strong></td>
        </tr>
        <tr>
            <td>正在请求重传</td>
            <td>正在回复其他客户端发来的重传请求</td>
        </tr>
        <tr>
            <td>文件释放完成</td>
            <td>真正意义上的文件发送完成</td>
        </tr>
    </tbody>
</table>
<p>注意：接收端最后可能不会显示<code>文件释放完成</code>，这是由于网络波动导致的bug，如果发送端显示了文件释放完成或者接收端10秒内没有接收到任何包，则也算完成。</p>
<h4>2.3.3 挂起文件</h4>
<p>请确保已经按照上文所述设置了Github 账号和PAT。
在离线前，点击菜单栏的<code>文件</code>，点击<code>挂起文件</code>，开始挂起。
<em><strong>注意，请勿在已经有文件挂起的时候再次进行文件挂起操作，否则会挂起失败！</strong></em>
在上线后点击<code>文件</code>-&gt;<code>下载同步的文件</code>下载。</p>
<br>
<h2>3 常见问题</h2>
<p>还没有常见问题。遇到问题请发送邮件到<a href="mailto:nnpyro2@outlook.com">nnpyro2@outlook.com</a></p>
